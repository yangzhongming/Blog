---
title: webpack基础入门
tags: [前端]
categories: 前端
images: 
date: 2019-02-28 21:00:00
---
## 网页中的静态资源
网页引用了过多的script,当页面加载过程中会发起多次二次请求，会导致网页加载速度慢。另外需要处理js之间错综复杂的依赖关系。为解决上述问题，引入了webpack。

## 什么是WebPack
[webpack ](http://webpack.github.io/)
是前端的一个项目构建工具，它是基于 Node.js 开发出来的一个前端工具。可通过webpack实现前端自动化构建，可以完美实现资源的合并、打包、压缩、混淆等诸多功能。

## webpack的安装
- 全局安装

        npm i webpack -g

- 安装到项目依赖

        npm i webpack --save-dev
  
  以上安装基于nodejs的安装，参考webpack(一)。

## 使用webpack进行项目的构建
- 项目初始化

        npm install packagename
        npm install jquery
	  
     初始化完成后，可看到项目生成package.json文件和node_modules文件夹。

- 1.创建主画面index.html：

		<!DOCTYPE html>
		<html lang="en">
		<head>
		    <meta charset="UTF-8">
		    <title>Title</title>
        <script src="main.js"></script>
		</head>
		<body>
		<ul>
		    <li>测试01......</li>
		    <li>测试02......</li>
		    <li>测试03......</li>
		    <li>测试04......</li>
		</ul>
		
		</body>
		</html>

- 2.创建主程序入口main.js：

   	    import $ from 'jQuery'

		$(function () {
		    $('li:odd').css('backgroundColor', 'yellow')
		    $('li:even').css('backgroundColor', function () {
		        return '#' + 'D97634'
		    })
		})


     运行结果：

        Uncaught SyntaxError: Unexpected identifier

     原因：

        浏览器无法解析ES6的代码，可使用webpack进行处理，webpack默认会把这种高级的语法转换为低级的浏览器能识别的语法。

        webpack ./src/main.js ./dist/bundle.js 

      会出现如下错误，原因是webpack版本过高，语法不兼容导致。可使用如下命令：
![782399670a53a576e7ce2f21645dd868.jpg](https://ww1.yunjiexi.club/2019/08/08/782399670a53a576e7ce2f21645dd868.jpg)

        webpack ./src/main.js --output ./dist/bundle.js --mode development

- 3.修改主画面index.html，画面显示正常

		<!DOCTYPE html>
		<html lang="en">
		<head>
		    <meta charset="UTF-8">
		    <title>Title</title>
        <script src="../dist/bundle.js"></script>
		</head>
		<body>
		<ul>
		    <li>测试01......</li>
		    <li>测试02......</li>
		    <li>测试03......</li>
		    <li>测试04......</li>
		</ul>
		
		</body>
		</html>


## 使用webpack.config.js简化打包过程
- 1.在项目根目录中创建webpack.config.js文件，代码如下：

            const  path = require('path')
            const webpack = require('webpack')

			
			module.exports = {
			    // 入口文件,webpack要对哪个文件进行打包
			    entry: path.join(__dirname,'./src/main.js'),
			    //出口文件
			    output: {
			        //打包后输出文件的目录
			        path:path.join(__dirname,'./dist'),
			        //打包后输出文件的名称
			        filename: "bundle.js"
			    }
			}

        配置完成后，在终端直接执行webpack进行编译打包并在dist目录下生成bundle.js

## 使用webpack实现实时打包
上述过程，只是简化了webpack打包时，不需要进行输入输出参数的设置。每次重新修改代码之后，都需要手动运行webpack打包的命令，重新生成打包编译后的bundle.js文件才能生效。可通过webpack-dev-server来实现代码实时打包编译。

- 1.安装webpack-dev-server

        npm i webpack-dev-server --save-dev


- 2.修改package.json
	
		"scripts": {
		    "dev": "webpack-dev-server"
		}

    此时直接在终端运行npm run dev(webpack-dev-server),可进行编译打包后，点击src后可直接打开index.html。

![4e9792953010a6b9565b0bd0bc196f7c.png](https://ww1.yunjiexi.club/2019/08/08/4e9792953010a6b9565b0bd0bc196f7c.png)


   注意：此时在dist目录下，并未生成bundle.js。此时通过webpack-dev-server生成的bundle.js是存在项目的根目录下基于内存的，因此画面对应的引用路径为：

       <script src="../bundle.js"></script>

- 3.为了解决通过访问localhost:8080直接打开index.html，可修改package.json：

        "scripts": {
        "dev": "webpack-dev-server --open --port 3000 --contentBase src --hot"
         },
         参数说明：
         --open 自动打开浏览器
         --port 设置访问端口，默认为8080
         --contentBase 指定托管的根目录
         --hot  实现热更新







- 创建主画面index.html：

		<!DOCTYPE html>
		<html lang="en">
		<head>
		    <meta charset="UTF-8">
		    <title>Title</title>
		</head>
          <!-- 1.通过 webpack 这么一个前端构建工具，把 main.js 做了一下处理，会生成了一个 bundle.js 的文件 -->
          <!-- <script src="../dist/bundle.js"></script> -->
          <!-- 2.当使用 html-webpack-plugin 之后，不再需要手动处理bundle.js 的引用路径了，这个插件会自动创建了一个合适的不可见的bundle.js在项目根目录下 -->
		<body>
		<ul>
		    <li>测试01......</li>
		    <li>测试02......</li>
		    <li>测试03......</li>
		    <li>测试04......</li>
		</ul>
		
		</body>
		</html>